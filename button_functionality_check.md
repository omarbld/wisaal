# فحص شامل لوظائف الأزرار في تطبيق وصال

## 1. شاشة المصادقة (auth_screen.dart)

### الأزرار والوظائف:
- ✅ **زر "المتابعة عبر البريد الإلكتروني"**: يرسل OTP للبريد الإلكتروني
- ✅ **زر "أنشئ حساباً جديداً"**: ينقل إلى شاشة التسجيل
- ✅ **التحقق من صحة البريد الإلكتروني**: يتحقق من وجود @ في البريد

### المشاكل المحتملة:
- ❌ **مطلوب فحص**: التأكد من أن إرسال OTP يعمل مع إعدادات Supabase

## 2. شاشة التسجيل (register_screen.dart)

### الأزرار والوظائف:
- ✅ **أزرار التنقل بين الخطوات**: السابق/التالي
- ✅ **اختيار المدينة**: قائمة منسدلة للمدن
- ✅ **اختيار الدور**: متبرع/جمعية/متطوع/مدير
- ✅ **إدخال كود التفعيل**: للجمعيات والمتطوعين والمديرين
- ✅ **موافقة على الشروط والأحكام**: checkbox مطلوب
- ✅ **زر "إنشاء الحساب"**: يرسل البيانات ويتوجه لـ OTP

### المشاكل المحتملة:
- ❌ **مطلوب فحص**: التحقق من صحة أكواد التفعيل في قاعدة البيانات
- ❌ **مطلوب فحص**: التأكد من أن دالة `register_volunteer` تعمل

## 3. شاشة OTP (otp_screen.dart)

### الأزرار والوظائف:
- ✅ **زر "التحقق والمتابعة"**: يتحقق من OTP ويسجل المستخدم
- ✅ **التحقق من طول الرمز**: يجب أن يكون 6 أرقام
- ✅ **توجيه المستخدم حسب الدور**: إلى الصفحة المناسبة

### المشاكل المحتملة:
- ❌ **مطلوب فحص**: التأكد من أن دالة `register_volunteer` موجودة في قاعدة البيانات

## 4. صفحة المتبرع (donor_home.dart)

### الأزرار والوظائف:
- ✅ **زر "إضافة تبرع جديد"**: ينقل إلى شاشة إضافة التبرع
- ✅ **بطاقات الإحصائيات**: تعرض إجمالي التبرعات والمكتملة والمعلقة
- ✅ **قائمة التبرعات الحديثة**: قابلة للنقر لعرض التفاصيل
- ✅ **القائمة الجانبية (Drawer)**: تحتوي على جميع الخيارات

### خيارات القائمة الجانبية:
- ✅ **إضافة تبرع جديد**: ينقل إلى AddDonationScreen
- ✅ **المتصدرون**: ينقل إلى LeaderboardPage
- ✅ **عرض سجل التبرعات**: ينقل إلى DonationsListScreen
- ✅ **الملف الشخصي**: ينقل إلى DonorProfileScreen
- ✅ **الإشعارات**: ينقل إلى DonorNotificationsScreen
- ✅ **تسجيل الخروج**: يسجل خروج المستخدم

## 5. صفحة الجمعية (association_home.dart)

### الأزرار والوظائف:
- ✅ **بطاقات الإحصائيات**: قابلة للنقر وتنقل إلى الصفحات المناسبة
  - تبرعات اليوم → AssociationTasksScreen
  - المتطوعين النشطين → AssociationVolunteersScreen
  - المهام المفتوحة → AssociationNearbyDonationsScreen
  - الوجبات الموزعة → AssociationInventoryScreen
- ✅ **بطاقات الطلبات العاجلة**: قابلة للنقر وتحتوي على زر "قبول"
- ✅ **رسم بياني دائري**: يعرض إحصائيات الأداء
- ✅ **قائمة المتطوعين المتصدرين**: تعرض أفضل المتطوعين

### خيارات القائمة الجانبية:
- ✅ **الرئ��سية**: يغلق القائمة
- ✅ **عرض التبرعات القريبة**: ينقل إلى AssociationNearbyDonationsScreen
- ✅ **مهامي**: ينقل إلى AssociationTasksScreen
- ✅ **إدارة المتطوعين**: ينقل إلى AssociationVolunteersScreen
- ✅ **الملف الشخصي**: ينقل إلى AssociationProfileScreen
- ✅ **أكواد تفعيل المتطوعين**: ينقل إلى AssociationActivationCodesScreen
- ✅ **التقارير والإحصائيات**: ينقل إلى AssociationReportsScreen
- ✅ **إدارة المخزون**: ينقل إلى AssociationInventoryScreen
- ✅ **الوضع الليلي**: مفتاح تبديل الثيم
- ✅ **تسجيل الخروج**: يسجل خروج المستخدم

## 6. الدوال المطلوبة في قاعدة البيانات

### دوال موجودة ومُصلحة:
- ✅ **get_association_report_data**: لصفحة التقارير
- ✅ **get_volunteers_for_association**: لاختيار المتطوعين
- ✅ **log_volunteer_hours**: لتسجيل ساعات المتطوعين
- ✅ **generate_share_text**: لإنشاء نص المشاركة
- ✅ **get_map_data_with_coordinates**: لبيانات الخريطة

### دوال مطلوب فحصها:
- ❌ **register_volunteer**: مطلوبة لتسجيل المتطوعين
- ❌ **get_top_volunteers**: مطلوبة لعرض أفضل المتطوعين
- ❌ **get_volunteer_dashboard_data**: لصفحة المتطوع الرئيسية
- ❌ **get_leaderboard**: لصفحة المتصدرين

## 7. مشاكل محتملة تحتاج فحص

### مشاكل في قاعدة البيانات:
1. **دالة register_volunteer مفقودة**
2. **دالة get_top_volunteers قد تحتاج إصلاح**
3. **جدول inventory قد يكون مفقود**
4. **view donations_with_coordinates قد تحتاج إصلاح**

### مشاكل في الكود:
1. **مسارات الصور**: التأكد من وجود assets/logo.png
2. **إعدادات Supabase**: التأكد من صحة الإعدادات
3. **صلاحيات قاعدة البيانات**: التأكد من RLS policies

## 8. خطة الفحص والإصلاح

### الخطوة 1: فحص الدوال المفقودة
```sql
-- فحص وجود الدوال المطلوبة
SELECT routine_name 
FROM information_schema.routines 
WHERE routine_schema = 'public' 
AND routine_name IN (
  'register_volunteer',
  'get_top_volunteers', 
  'get_volunteer_dashboard_data',
  'get_leaderboard'
);
```

### الخطوة 2: فحص الجداول والـ Views
```sql
-- فحص وجود الجداول المطلوبة
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('inventory', 'donations_with_coordinates');
```

### الخطوة 3: اختبار الوظائف
1. تسجيل مستخدم جديد كمتبرع
2. تسجيل مستخدم جديد كجمعية
3. تسجيل مستخدم جديد كمتطوع (مع كود تفعيل)
4. إضافة تبرع جديد
5. قبول تبرع من الجمعية
6. تعيين متطوع للتبرع
7. عرض التقارير والإحصائيات

## 9. التوصيات

### إصلاحات فورية مطلوبة:
1. **إنشاء الدوال المفقودة** في قاعدة البيانات
2. **إنشاء جدول inventory** إذا كان مفقود
3. **إصلاح view donations_with_coordinates**
4. **التأكد من وجود ملفات الـ assets**

### اختبارات مطلوبة:
1. **اختبار تدفق التسجيل الكامل**
2. **اختبار جميع الأزرار في كل صفحة**
3. **اختبار التنقل بين الصفحات**
4. **اختبار الوظائف التفاعلية**

### تحسينات مقترحة:
1. **إضافة loading states** لجميع الأزرار
2. **إضافة error handling** أفضل
3. **إضافة confirmation dialogs** للعمليات المهمة
4. **تحسين UX** للأزرا�� والتفاعلات